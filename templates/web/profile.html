{% extends "base.html" %}

{% block content %}
<div class="container">
    <h2 class="text-center">Update Profile</h2>
    <div class="row">
        <div class="col-md-4">
            <h4>Profile Picture</h4>
            <!-- Image preview -->
            <img id="profileImagePreview" src="{{ user.profile_image_url }}" alt="Profile Image" class="img-thumbnail" width="200">
            <br><br>
            <label for="id_profile_image" class="btn btn-primary">
                Change Profile Picture
            </label>
            <input type="file" id="id_profile_image" style="display:none;" onchange="previewImage(event)">
        </div>

        <div class="col-md-8">
            <form method="POST" enctype="multipart/form-data">
                {% csrf_token %}
                <div class="form-group">
                    <label for="id_username">Username</label>
                    <input type="text" class="form-control" id="id_username" name="username" value="{{ user.username }}" required>
                </div>
                
                <div class="form-group">
                    <label for="id_email">Email</label>
                    <input type="email" class="form-control" id="id_email" name="email" value="{{ user.email }}" required>
                </div>

                <div class="form-group">
                    <label for="id_phone_number">Phone Number</label>
                    <input type="text" class="form-control" id="id_phone_number" name="phone_number" value="{{ user.phone_number }}">
                </div>

                <div class="form-group">
                    <label for="id_blood_group">Blood Group</label>
                    <select class="form-control" id="id_blood_group" name="blood_group">
                        <option value="">Select your blood group</option>
                        <option value="A+" {% if user.blood_group == "A+" %}selected{% endif %}>A+</option>
                        <option value="A-" {% if user.blood_group == "A-" %}selected{% endif %}>A-</option>
                        <option value="B+" {% if user.blood_group == "B+" %}selected{% endif %}>B+</option>
                        <option value="B-" {% if user.blood_group == "B-" %}selected{% endif %}>B-</option>
                        <option value="AB+" {% if user.blood_group == "AB+" %}selected{% endif %}>AB+</option>
                        <option value="AB-" {% if user.blood_group == "AB-" %}selected{% endif %}>AB-</option>
                        <option value="O+" {% if user.blood_group == "O+" %}selected{% endif %}>O+</option>
                        <option value="O-" {% if user.blood_group == "O-" %}selected{% endif %}>O-</option>
                    </select>
                </div>
                

                <div class="form-group">
                    <label for="id_location">Location</label>
                    <input type="text" class="form-control" id="id_location" name="location" value="{{ user.location }}">
                </div>

                <div class="form-group">
                    <label for="id_user_type">User Type</label>
                    <select class="form-control" id="id_user_type" name="user_type" disabled>
                        <option value="donor" {% if user.user_type == 'donor' %}selected{% endif %}>Donor</option>
                        <option value="recipient" {% if user.user_type == 'recipient' %}selected{% endif %}>Recipient</option>
                    </select>
                </div>

                <button type="submit" class="btn btn-success">Update Profile</button>
            </form>
        </div>
    </div>
</div>

<!-- Script to preview image -->
<script>
    function previewImage(event) {
        const reader = new FileReader();
        reader.onload = function(){
            const output = document.getElementById('profileImagePreview');
            output.src = reader.result;
        };
        reader.readAsDataURL(event.target.files[0]);
    }
</script>
{% endblock %}
